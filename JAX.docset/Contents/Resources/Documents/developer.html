
<!DOCTYPE html>

<html data-content_root="./" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Building from source â€” JAX  documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet"/>
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet"/>
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet"/>
<link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="_static/pygments.css?v=a746c00c" rel="stylesheet" type="text/css"/>
<link href="_static/styles/sphinx-book-theme.css?v=384b581d" rel="stylesheet" type="text/css"/>
<link href="_static/plot_directive.css" rel="stylesheet" type="text/css"/>
<link href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" rel="stylesheet" type="text/css"/>
<link href="_static/style.css?v=02ed413a" rel="stylesheet" type="text/css"/>
<link href="_static/style.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" rel="preload"/>
<link as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" rel="preload"/>
<script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/documentation_options.js?v=9eb32ce0"></script>
<script src="_static/doctools.js?v=9a2dae69"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/clipboard.min.js?v=a7894cd8"></script>
<script src="_static/copybutton.js?v=f281be69"></script>
<script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
<script src="_static/design-tabs.js?v=36754332"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'developer';</script>
<link href="_static/favicon.png" rel="icon"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="jax_internal_api.html" rel="next" title="Internal APIs"/>
<link href="contributing.html" rel="prev" title="Contributing to JAX"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<a class="skip-link" href="#main-content" id="pst-skip-link">Skip to main content</a>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar">
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="index.html">
<img alt="JAX  documentation - Home" class="logo__image only-light" src="_static/jax_logo_250px.png"/>
<script>document.write(`<img src="_static/jax_logo_250px.png" class="logo__image only-dark" alt="JAX  documentation - Home"/>`);</script>
</a></div>
<div class="sidebar-primary-item">
<script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing JAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/quickstart.html">JAX Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/thinking_in_jax.html">How to Think in JAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Common_Gotchas_in_JAX.html">ðŸ”ª JAX - The Sharp Bits ðŸ”ª</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">JAX Frequently Asked Questions (FAQ)</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="jax-101/index.html">Tutorial: JAX 101</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="jax-101/01-jax-basics.html">JAX As Accelerated NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/02-jitting.html">Just In Time Compilation with JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/03-vectorization.html">Automatic Vectorization in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/04-advanced-autodiff.html">Advanced Automatic Differentiation in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/05-random-numbers.html">Pseudo Random Numbers in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/05.1-pytrees.html">Working with Pytrees</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/06-parallelism.html">Parallel Evaluation in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-101/07-state.html">Stateful Computations in JAX</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Resources</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="user_guides.html">User Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling JAX programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_memory_profiling.html">Device Memory Profiling</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="debugging/index.html">Runtime value debugging in JAX</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="debugging/print_breakpoint.html"><code class="docutils literal notranslate"><span class="pre">jax.debug.print</span></code> and <code class="docutils literal notranslate"><span class="pre">jax.debug.breakpoint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="debugging/checkify_guide.html">The <code class="docutils literal notranslate"><span class="pre">checkify</span></code> transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="debugging/flags.html">JAX debugging flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gpu_performance_tips.html">GPU performance tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="persistent_compilation_cache.html">Persistent Compilation Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxpr.html">Understanding Jaxprs</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/external_callbacks.html">External Callbacks in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="type_promotion.html">Type promotion semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pytrees.html">Pytrees</a></li>
<li class="toctree-l2"><a class="reference internal" href="aot.html">Ahead-of-time lowering and compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">JAX Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="transfer_guard.html">Transfer guard</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pallas/index.html">Pallas: a JAX kernel language</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pallas/design.html">Pallas Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="pallas/quickstart.html">Pallas Quickstart</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pallas/tpu/index.html">Pallas TPU</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pallas/tpu/details.html">Writing TPU kernels with Pallas</a></li>
<li class="toctree-l4"><a class="reference internal" href="pallas/tpu/pipelining.html">Pipelining and <code class="docutils literal notranslate"><span class="pre">BlockSpec</span></code>s</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced_guide.html">Advanced Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks/neural_network_with_tfds_data.html">Training a Simple Neural Network, with tensorflow/datasets Data Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/Neural_Network_and_Data_Loading.html">Training a Simple Neural Network, with PyTorch Data Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/vmapped_log_probs.html">Autobatching for Bayesian Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_process.html">Using JAX in multi-host and multi-process environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/Distributed_arrays_and_automatic_parallelization.html">Distributed arrays and automatic parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/shard_map.html">SPMD multi-device parallelism with <code class="docutils literal notranslate"><span class="pre">shard_map</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/xmap_tutorial.html">Named axes and easy-to-revise parallelism with <code class="docutils literal notranslate"><span class="pre">xmap</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/autodiff_cookbook.html">The Autodiff Cookbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/Custom_derivative_rules_for_Python_code.html">Custom derivative rules for JAX-transformable Python functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/autodiff_remat.html">Control autodiffâ€™s saved values with <code class="docutils literal notranslate"><span class="pre">jax.checkpoint</span></code> (aka <code class="docutils literal notranslate"><span class="pre">jax.remat</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/How_JAX_primitives_work.html">How JAX primitives work</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/Writing_custom_interpreters_in_Jax.html">Writing custom Jaxpr interpreters in JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="Custom_Operation_for_GPUs.html">Custom operations for GPUs with C++ and CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/convolutions.html">Generalized Convolutions in JAX</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="contributor_guide.html">Developer Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to JAX</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Building from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax_internal_api.html">Internal APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="autodidax.html">Autodidax: JAX core from scratch</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jep/index.html">JAX Enhancement Proposals (JEPs)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="jep/263-prng.html">263: JAX PRNG Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/2026-custom-derivatives.html">2026: Custom JVP/VJP rules for JAX-transformable functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/4008-custom-vjp-update.html">4008: Custom VJP and `nondiff_argnums` update</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/4410-omnistaging.html">4410: Omnistaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/9263-typed-keys.html">9263: Typed keys &amp; pluggable RNGs</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/9407-type-promotion.html">9407: Design of Type Promotion Semantics for JAX</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/9419-jax-versioning.html">9419: Jax and Jaxlib versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/10657-sequencing-effects.html">10657: Sequencing side-effects in JAX</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/11830-new-remat-checkpoint.html">11830: `jax.remat` / `jax.checkpoint` new implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/12049-type-annotations.html">12049: Type Annotation Roadmap for JAX</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/14273-shard-map.html">14273: `shard_map` (`shmap`) for simple per-device code</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/15856-jex.html">15856: `jax.extend`, an extensions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/17111-shmap-transpose.html">17111: Efficient transposition of `shard_map` (and other maps)</a></li>
<li class="toctree-l3"><a class="reference internal" href="jep/18137-numpy-scipy-scope.html">18137: Scope of JAX NumPy &amp; SciPy Wrappers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="investigating_a_regression.html">Investigating a regression</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building_on_jax.html">Building on JAX</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="notes.html">Notes</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api_compatibility.html">API compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="deprecation.html">Python and NumPy version support policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax_array_migration.html">jax.Array migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="async_dispatch.html">Asynchronous dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrency.html">Concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpu_memory_allocation.html">GPU memory allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rank_promotion_warning.html">Rank promotion warning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="jax.html">Public API: jax package</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.numpy.html"><code class="docutils literal notranslate"><span class="pre">jax.numpy</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.fft.html">jax.numpy.fft.fft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.fft2.html">jax.numpy.fft.fft2</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.fftfreq.html">jax.numpy.fft.fftfreq</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.fftn.html">jax.numpy.fft.fftn</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.fftshift.html">jax.numpy.fft.fftshift</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.hfft.html">jax.numpy.fft.hfft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.ifft.html">jax.numpy.fft.ifft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.ifft2.html">jax.numpy.fft.ifft2</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.ifftn.html">jax.numpy.fft.ifftn</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.ifftshift.html">jax.numpy.fft.ifftshift</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.ihfft.html">jax.numpy.fft.ihfft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.irfft.html">jax.numpy.fft.irfft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.irfft2.html">jax.numpy.fft.irfft2</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.irfftn.html">jax.numpy.fft.irfftn</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.rfft.html">jax.numpy.fft.rfft</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.rfft2.html">jax.numpy.fft.rfft2</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.rfftfreq.html">jax.numpy.fft.rfftfreq</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.numpy.fft.rfftn.html">jax.numpy.fft.rfftn</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.scipy.html"><code class="docutils literal notranslate"><span class="pre">jax.scipy</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.scipy.stats.bernoulli.logpmf.html">jax.scipy.stats.bernoulli.logpmf</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.scipy.stats.bernoulli.pmf.html">jax.scipy.stats.bernoulli.pmf</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.scipy.stats.bernoulli.cdf.html">jax.scipy.stats.bernoulli.cdf</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/jax.scipy.stats.bernoulli.ppf.html">jax.scipy.stats.bernoulli.ppf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jax.lax.html"><code class="docutils literal notranslate"><span class="pre">jax.lax</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.random.html"><code class="docutils literal notranslate"><span class="pre">jax.random</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.sharding.html"><code class="docutils literal notranslate"><span class="pre">jax.sharding</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.debug.html"><code class="docutils literal notranslate"><span class="pre">jax.debug</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.dlpack.html"><code class="docutils literal notranslate"><span class="pre">jax.dlpack</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.distributed.html"><code class="docutils literal notranslate"><span class="pre">jax.distributed</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.dtypes.html"><code class="docutils literal notranslate"><span class="pre">jax.dtypes</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.flatten_util.html"><code class="docutils literal notranslate"><span class="pre">jax.flatten_util</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.image.html"><code class="docutils literal notranslate"><span class="pre">jax.image</span></code> module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.nn.html"><code class="docutils literal notranslate"><span class="pre">jax.nn</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="jax.nn.initializers.html"><code class="docutils literal notranslate"><span class="pre">jax.nn.initializers</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jax.ops.html"><code class="docutils literal notranslate"><span class="pre">jax.ops</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.profiler.html"><code class="docutils literal notranslate"><span class="pre">jax.profiler</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.stages.html"><code class="docutils literal notranslate"><span class="pre">jax.stages</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.tree.html"><code class="docutils literal notranslate"><span class="pre">jax.tree</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.tree_util.html"><code class="docutils literal notranslate"><span class="pre">jax.tree_util</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax.typing.html"><code class="docutils literal notranslate"><span class="pre">jax.typing</span></code> module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.extend.html"><code class="docutils literal notranslate"><span class="pre">jax.extend</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="jax.extend.linear_util.html"><code class="docutils literal notranslate"><span class="pre">jax.extend.linear_util</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.extend.mlir.html"><code class="docutils literal notranslate"><span class="pre">jax.extend.mlir</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.extend.random.html"><code class="docutils literal notranslate"><span class="pre">jax.extend.random</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.example_libraries.html"><code class="docutils literal notranslate"><span class="pre">jax.example_libraries</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="jax.example_libraries.optimizers.html"><code class="docutils literal notranslate"><span class="pre">jax.example_libraries.optimizers</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.example_libraries.stax.html"><code class="docutils literal notranslate"><span class="pre">jax.example_libraries.stax</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="jax.experimental.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.array_api.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.array_api</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.checkify.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.checkify</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.host_callback.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.host_callback</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.maps.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.maps</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.pjit.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.pjit</span></code> module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="jax.experimental.sparse.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.sparse</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.BCOO.html">jax.experimental.sparse.BCOO</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_broadcast_in_dim.html">jax.experimental.sparse.bcoo_broadcast_in_dim</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_concatenate.html">jax.experimental.sparse.bcoo_concatenate</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_dot_general.html">jax.experimental.sparse.bcoo_dot_general</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_dot_general_sampled.html">jax.experimental.sparse.bcoo_dot_general_sampled</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_dynamic_slice.html">jax.experimental.sparse.bcoo_dynamic_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_extract.html">jax.experimental.sparse.bcoo_extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_fromdense.html">jax.experimental.sparse.bcoo_fromdense</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_gather.html">jax.experimental.sparse.bcoo_gather</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_multiply_dense.html">jax.experimental.sparse.bcoo_multiply_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_multiply_sparse.html">jax.experimental.sparse.bcoo_multiply_sparse</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_update_layout.html">jax.experimental.sparse.bcoo_update_layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_reduce_sum.html">jax.experimental.sparse.bcoo_reduce_sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_reshape.html">jax.experimental.sparse.bcoo_reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_slice.html">jax.experimental.sparse.bcoo_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_sort_indices.html">jax.experimental.sparse.bcoo_sort_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_squeeze.html">jax.experimental.sparse.bcoo_squeeze</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_sum_duplicates.html">jax.experimental.sparse.bcoo_sum_duplicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_todense.html">jax.experimental.sparse.bcoo_todense</a></li>
<li class="toctree-l4"><a class="reference internal" href="_autosummary/jax.experimental.sparse.bcoo_transpose.html">jax.experimental.sparse.bcoo_transpose</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.jet.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.jet</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.custom_partitioning.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.custom_partitioning</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.multihost_utils.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.multihost_utils</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.compilation_cache.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.compilation_cache</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.key_reuse.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.key_reuse</span></code> module</a></li>
<li class="toctree-l3"><a class="reference internal" href="jax.experimental.mesh_utils.html"><code class="docutils literal notranslate"><span class="pre">jax.experimental.mesh_utils</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jax.lib.html"><code class="docutils literal notranslate"><span class="pre">jax.lib</span></code> module</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">JAX Glossary of Terms</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<a class="btn btn-sm btn-source-repository-button" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/google/jax" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
</a>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-download-source-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="_sources/developer.md" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.md</span>
</a>
</li>
<li>
<button class="btn btn-sm btn-download-pdf-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" onclick="window.print()" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Building from source</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-or-installing-jaxlib">Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-jaxlib-with-pip">Installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with pip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-jaxlib-from-source">Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-jaxlib-from-source-with-a-modified-xla-repository">Building jaxlib from source with a modified XLA repository.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-notes-for-building-jaxlib-from-source-on-windows">Additional Notes for Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source on Windows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-notes-for-building-a-rocm-jaxlib-for-amd-gpus">Additional notes for building a ROCM <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> for AMD GPUs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-jax">Installing <code class="docutils literal notranslate"><span class="pre">jax</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-tests">Running the tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bazel">Using Bazel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pytest">Using <code class="docutils literal notranslate"><span class="pre">pytest</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-test-behavior">Controlling test behavior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#doctests">Doctests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#type-checking">Type checking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linting">Linting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-documentation">Update documentation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-notebooks">Update notebooks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#editing-ipynb">Editing <code class="docutils literal notranslate"><span class="pre">ipynb</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#editing-md">Editing <code class="docutils literal notranslate"><span class="pre">md</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#syncing-notebooks">Syncing notebooks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-new-notebooks">Creating new notebooks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notebooks-within-the-sphinx-build">Notebooks within the Sphinx build</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-building-on-readthedocs-io">Documentation building on <code class="docutils literal notranslate"><span class="pre">readthedocs.io</span></code></a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Building from source"></a><section class="tex2jax_ignore mathjax_ignore" id="building-from-source">
<span id="id1"></span><h1>Building from source<a class="headerlink" href="#building-from-source" title="Link to this heading">#</a></h1>
<p>First, obtain the JAX source code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">jax</span>
<span class="n">cd</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Building JAX involves two steps:</p>
<ol class="arabic simple">
<li><p>Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, the C++ support library for <code class="docutils literal notranslate"><span class="pre">jax</span></code>.</p></li>
<li><p>Installing the <code class="docutils literal notranslate"><span class="pre">jax</span></code> Python package.</p></li>
</ol>
<section id="building-or-installing-jaxlib">
<h2>Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code><a class="headerlink" href="#building-or-installing-jaxlib" title="Link to this heading">#</a></h2>
<section id="installing-jaxlib-with-pip">
<h3>Installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with pip<a class="headerlink" href="#installing-jaxlib-with-pip" title="Link to this heading">#</a></h3>
<p>If youâ€™re only modifying Python portions of JAX, we recommend installing
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from a prebuilt wheel using pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jaxlib</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://github.com/google/jax#installation">JAX readme</a> for full
guidance on pip installation (e.g., for GPU and TPU support).</p>
</section>
<section id="building-jaxlib-from-source">
<h3>Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source<a class="headerlink" href="#building-jaxlib-from-source" title="Link to this heading">#</a></h3>
<p>To build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source, you must also install some prerequisites:</p>
<ul>
<li><p>a C++ compiler (g++, clang, or MSVC)</p>
<p>On Ubuntu or Debian you can install the necessary prerequisites with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">g</span><span class="o">++</span> <span class="n">python</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>If you are building on a Mac, make sure XCode and the XCode command line tools
are installed.</p>
<p>See below for Windows build instructions.</p>
</li>
<li><p>Python packages: <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">wheel</span></code>, <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p></li>
</ul>
<p>You can install the necessary Python dependencies using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">wheel</span> <span class="n">build</span>
</pre></div>
</div>
<p>To build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> for CPU or TPU, you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">dist</span><span class="o">/*.</span><span class="n">whl</span>  <span class="c1"># installs jaxlib (includes XLA)</span>
</pre></div>
</div>
<p>There are two ways to build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with CUDA support: (1) use
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--enable_cuda</span></code> to generate a jaxlib wheel with cuda
support, or (2) use
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--enable_cuda</span> <span class="pre">--build_gpu_plugin</span> <span class="pre">--gpu_plugin_cuda_version=12</span></code>
to generate three wheels (jaxlib without cuda, jax-cuda-plugin,
and jax-cuda-pjrt). You can set <code class="docutils literal notranslate"><span class="pre">gpu_plugin_cuda_version</span></code> to 11 or 12.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--help</span></code> for configuration options, including ways to
specify the paths to CUDA and CUDNN, which you must have installed. Here
<code class="docutils literal notranslate"><span class="pre">python</span></code> should be the name of your Python 3 interpreter; on some systems, you
may need to use <code class="docutils literal notranslate"><span class="pre">python3</span></code> instead. By default, the wheel is written to the
<code class="docutils literal notranslate"><span class="pre">dist/</span></code> subdirectory of the current directory.</p>
</section>
<section id="building-jaxlib-from-source-with-a-modified-xla-repository">
<h3>Building jaxlib from source with a modified XLA repository.<a class="headerlink" href="#building-jaxlib-from-source-with-a-modified-xla-repository" title="Link to this heading">#</a></h3>
<p>JAX depends on XLA, whose source code is in the
<a class="reference external" href="https://github.com/openxla/xla">XLA GitHub repository</a>.
By default JAX uses a pinned copy of the XLA repository, but we often
want to use a locally-modified copy of XLA when working on JAX. There are two
ways to do this:</p>
<ul>
<li><p>use Bazelâ€™s <code class="docutils literal notranslate"><span class="pre">override_repository</span></code> feature, which you can pass as a command
line flag to <code class="docutils literal notranslate"><span class="pre">build.py</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">bazel_options</span><span class="o">=--</span><span class="n">override_repository</span><span class="o">=</span><span class="n">xla</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">xla</span>
</pre></div>
</div>
</li>
<li><p>modify the <code class="docutils literal notranslate"><span class="pre">WORKSPACE</span></code> file in the root of the JAX source tree to point to
a different XLA tree.</p></li>
</ul>
<p>To contribute changes back to XLA, send PRs to the XLA repository.</p>
<p>The version of XLA pinned by JAX is regularly updated, but is updated in
particular before each <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> release.</p>
</section>
<section id="additional-notes-for-building-jaxlib-from-source-on-windows">
<h3>Additional Notes for Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source on Windows<a class="headerlink" href="#additional-notes-for-building-jaxlib-from-source-on-windows" title="Link to this heading">#</a></h3>
<p>On Windows, follow <a class="reference external" href="https://docs.microsoft.com/en-us/visualstudio/install/install-visual-studio?view=vs-2019">Install Visual Studio</a>
to set up a C++ toolchain. Visual Studio 2019 version 16.5 or newer is required.
If you need to build with CUDA enabled, follow the
<a class="reference external" href="https://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/index.html">CUDA Installation Guide</a>
to set up a CUDA environment.</p>
<p>JAX builds use symbolic links, which require that you activate
<a class="reference external" href="https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development">Developer Mode</a>.</p>
<p>You can either install Python using its
<a class="reference external" href="https://www.python.org/downloads/">Windows installer</a>, or if you prefer, you
can use <a class="reference external" href="https://docs.anaconda.com/anaconda/install/windows/">Anaconda</a>
or <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html#windows-installers">Miniconda</a>
to set up a Python environment.</p>
<p>Some targets of Bazel use bash utilities to do scripting, so <a class="reference external" href="https://www.msys2.org">MSYS2</a>
is needed. See <a class="reference external" href="https://bazel.build/install/windows#install-compilers">Installing Bazel on Windows</a>
for more details. Install the following packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pacman</span> <span class="o">-</span><span class="n">S</span> <span class="n">patch</span> <span class="n">coreutils</span>
</pre></div>
</div>
<p>Once coreutils is installed, the realpath command should be present in your shellâ€™s path.</p>
<p>Once everything is installed. Open PowerShell, and make sure MSYS2 is in the
path of the current session. Ensure <code class="docutils literal notranslate"><span class="pre">bazel</span></code>, <code class="docutils literal notranslate"><span class="pre">patch</span></code> and <code class="docutils literal notranslate"><span class="pre">realpath</span></code> are
accessible. Activate the conda environment. The following command builds with
CUDA enabled, adjust it to whatever suitable for you:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>python .\build\build.py `
  --enable_cuda `
  --cuda_path='C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1' `
  --cudnn_path='C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1' `
  --cuda_version='10.1' `
  --cudnn_version='7.6.5'
</pre></div>
</div>
<p>To build with debug information, add the flag <code class="docutils literal notranslate"><span class="pre">--bazel_options='--copt=/Z7'</span></code>.</p>
</section>
<section id="additional-notes-for-building-a-rocm-jaxlib-for-amd-gpus">
<h3>Additional notes for building a ROCM <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> for AMD GPUs<a class="headerlink" href="#additional-notes-for-building-a-rocm-jaxlib-for-amd-gpus" title="Link to this heading">#</a></h3>
<p>You need several ROCM/HIP libraries installed to build for ROCM. For
example, on a Ubuntu machine with
<a class="reference external" href="https://rocm.docs.amd.com/en/latest/deploy/linux/quick_start.html">AMDâ€™s <code class="docutils literal notranslate"><span class="pre">apt</span></code> repositories available</a>,
you need a number of packages installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">miopen</span><span class="o">-</span><span class="n">hip</span> <span class="n">hipfft</span><span class="o">-</span><span class="n">dev</span> <span class="n">rocrand</span><span class="o">-</span><span class="n">dev</span> <span class="n">hipsparse</span><span class="o">-</span><span class="n">dev</span> <span class="n">hipsolver</span><span class="o">-</span><span class="n">dev</span> \
    <span class="n">rccl</span><span class="o">-</span><span class="n">dev</span> <span class="n">rccl</span> <span class="n">hip</span><span class="o">-</span><span class="n">dev</span> <span class="n">rocfft</span><span class="o">-</span><span class="n">dev</span> <span class="n">roctracer</span><span class="o">-</span><span class="n">dev</span> <span class="n">hipblas</span><span class="o">-</span><span class="n">dev</span> <span class="n">rocm</span><span class="o">-</span><span class="n">device</span><span class="o">-</span><span class="n">libs</span>
</pre></div>
</div>
<p>To build jaxlib with ROCM support, you can run the following build command,
suitably adjusted for your paths and ROCM version.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">enable_rocm</span> <span class="o">--</span><span class="n">rocm_path</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span><span class="o">-</span><span class="mf">5.7.0</span>
</pre></div>
</div>
<p>AMDâ€™s fork of the XLA repository may include fixes not present in the upstream
XLA repository. If you experience problems with the upstream repository, you can
try AMDâ€™s fork, by cloning their repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">xla</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>and override the XLA repository with which JAX is built:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">enable_rocm</span> <span class="o">--</span><span class="n">rocm_path</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span><span class="o">-</span><span class="mf">5.7.0</span> \
  <span class="o">--</span><span class="n">bazel_options</span><span class="o">=--</span><span class="n">override_repository</span><span class="o">=</span><span class="n">xla</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">xla</span><span class="o">-</span><span class="n">rocm</span>
</pre></div>
</div>
</section>
</section>
<section id="installing-jax">
<h2>Installing <code class="docutils literal notranslate"><span class="pre">jax</span></code><a class="headerlink" href="#installing-jax" title="Link to this heading">#</a></h2>
<p>Once <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> has been installed, you can install <code class="docutils literal notranslate"><span class="pre">jax</span></code> by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>  <span class="c1"># installs jax</span>
</pre></div>
</div>
<p>To upgrade to the latest version from GitHub, just run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> from the JAX
repository root, and rebuild by running <code class="docutils literal notranslate"><span class="pre">build.py</span></code> or upgrading <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> if
necessary. You shouldnâ€™t have to reinstall <code class="docutils literal notranslate"><span class="pre">jax</span></code> because <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span></code>
sets up symbolic links from site-packages into the repository.</p>
</section>
<section id="running-the-tests">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Running the tests"></a><span id="running-tests"></span><h2>Running the tests<a class="headerlink" href="#running-the-tests" title="Link to this heading">#</a></h2>
<p>First, install the dependencies by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">build/test-requirements.txt</span></code>.</p>
<p>There are two supported mechanisms for running the JAX tests, either using Bazel
or using pytest.</p>
<section id="using-bazel">
<h3>Using Bazel<a class="headerlink" href="#using-bazel" title="Link to this heading">#</a></h3>
<p>First, configure the JAX build by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">configure_only</span>
</pre></div>
</div>
<p>You may pass additional options to <code class="docutils literal notranslate"><span class="pre">build.py</span></code> to configure the build; see the
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> build documentation for details.</p>
<p>By default the Bazel build runs the JAX tests using <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> built from source.
To run JAX tests, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">cpu_tests</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">backend_independent_tests</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">//tests:gpu_tests</span></code> and <code class="docutils literal notranslate"><span class="pre">//tests:tpu_tests</span></code> are also available, if you have the necessary hardware.</p>
<p>To use a preinstalled <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> instead of building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source, run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">--//</span><span class="n">jax</span><span class="p">:</span><span class="n">build_jaxlib</span><span class="o">=</span><span class="n">false</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">cpu_tests</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">backend_independent_tests</span>
</pre></div>
</div>
<p>A number of test behaviors can be controlled using environment variables (see
below). Environment variables may be passed to JAX tests using the
<code class="docutils literal notranslate"><span class="pre">--test_env=FLAG=value</span></code> flag to Bazel.</p>
<p>Some of JAX tests are for multiple accelerators (i.e. GPUs, TPUs). When JAX is already installed, you can run GPUs tests like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">gpu_tests</span> <span class="o">--</span><span class="n">local_test_jobs</span><span class="o">=</span><span class="mi">4</span> <span class="o">--</span><span class="n">test_tag_filters</span><span class="o">=</span><span class="n">multiaccelerator</span> <span class="o">--//</span><span class="n">jax</span><span class="p">:</span><span class="n">build_jaxlib</span><span class="o">=</span><span class="n">false</span> <span class="o">--</span><span class="n">test_env</span><span class="o">=</span><span class="n">XLA_PYTHON_CLIENT_ALLOCATOR</span><span class="o">=</span><span class="n">platform</span>
</pre></div>
</div>
<p>You can speed up single accelerator tests by running them in parallel on multiple accelerators. This also triggers multiple concurrent tests per accelerator. For GPUs, you can do it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NB_GPUS=2
JOBS_PER_ACC=4
J=$((NB_GPUS * JOBS_PER_ACC))
MULTI_GPU="--run_under $PWD/build/parallel_accelerator_execute.sh --test_env=JAX_ACCELERATOR_COUNT=${NB_GPUS} --test_env=JAX_TESTS_PER_ACCELERATOR=${JOBS_PER_ACC} --local_test_jobs=$J"
bazel test //tests:gpu_tests //tests:backend_independent_tests --test_env=XLA_PYTHON_CLIENT_PREALLOCATE=false --test_tag_filters=-multiaccelerator $MULTI_GPU
</pre></div>
</div>
<p>Some test targets, like a <code class="docutils literal notranslate"><span class="pre">//tests:logpcg_tests</span></code> optionally use matplotlib, so you may need to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code> to run tests via bazel.</p>
</section>
<section id="using-pytest">
<h3>Using <code class="docutils literal notranslate"><span class="pre">pytest</span></code><a class="headerlink" href="#using-pytest" title="Link to this heading">#</a></h3>
<p>To run all the JAX tests using <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, we recommend using <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>,
which can run tests in parallel. It is installed as a part of
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">build/test-requirements.txt</span></code> command.</p>
<p>From the repository root directory run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
</section>
<section id="controlling-test-behavior">
<h3>Controlling test behavior<a class="headerlink" href="#controlling-test-behavior" title="Link to this heading">#</a></h3>
<p>JAX generates test cases combinatorially, and you can control the number of
cases that are generated and checked for each test (default is 10) using the
<code class="docutils literal notranslate"><span class="pre">JAX_NUM_GENERATED_CASES</span></code> environment variable. The automated tests
currently use 25 by default.</p>
<p>For example, one might write</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Bazel
bazel test //tests/... --test_env=JAX_NUM_GENERATED_CASES=25`
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pytest</span>
<span class="n">JAX_NUM_GENERATED_CASES</span><span class="o">=</span><span class="mi">25</span> <span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
<p>The automated tests also run the tests with default 64-bit floats and ints
(<code class="docutils literal notranslate"><span class="pre">JAX_ENABLE_X64</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JAX_ENABLE_X64</span><span class="o">=</span><span class="mi">1</span> <span class="n">JAX_NUM_GENERATED_CASES</span><span class="o">=</span><span class="mi">25</span> <span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
<p>You can run a more specific set of tests using
<a class="reference external" href="https://docs.pytest.org/en/latest/usage.html#specifying-tests-selecting-tests">pytest</a>â€™s
built-in selection mechanisms, or alternatively you can run a specific test
file directly to see more detailed information about the cases being run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JAX_NUM_GENERATED_CASES</span><span class="o">=</span><span class="mi">5</span> <span class="n">python</span> <span class="n">tests</span><span class="o">/</span><span class="n">lax_numpy_test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>You can skip a few tests known to be slow, by passing environment variable
JAX_SKIP_SLOW_TESTS=1.</p>
<p>To specify a particular set of tests to run from a test file, you can pass a string
or regular expression via the <code class="docutils literal notranslate"><span class="pre">--test_targets</span></code> flag. For example, you can run all
the tests of <code class="docutils literal notranslate"><span class="pre">jax.numpy.pad</span></code> using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">tests</span><span class="o">/</span><span class="n">lax_numpy_test</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">test_targets</span><span class="o">=</span><span class="s2">"testPad"</span>
</pre></div>
</div>
<p>The Colab notebooks are tested for errors as part of the documentation build.</p>
</section>
<section id="doctests">
<h3>Doctests<a class="headerlink" href="#doctests" title="Link to this heading">#</a></h3>
<p>JAX uses pytest in doctest mode to test the code examples within the documentation.
You can run this using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="n">docs</span>
</pre></div>
</div>
<p>Additionally, JAX runs pytest in <code class="docutils literal notranslate"><span class="pre">doctest-modules</span></code> mode to ensure code examples in
function docstrings will run correctly. You can run this locally using, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">doctest</span><span class="o">-</span><span class="n">modules</span> <span class="n">jax</span><span class="o">/</span><span class="n">_src</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">lax_numpy</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Keep in mind that there are several files that are marked to be skipped when the
doctest command is run on the full package; you can see the details in
<a class="reference external" href="https://github.com/google/jax/blob/main/.github/workflows/ci-build.yaml"><code class="docutils literal notranslate"><span class="pre">ci-build.yaml</span></code></a></p>
</section>
</section>
<section id="type-checking">
<h2>Type checking<a class="headerlink" href="#type-checking" title="Link to this heading">#</a></h2>
<p>We use <code class="docutils literal notranslate"><span class="pre">mypy</span></code> to check the type hints. To check types locally the same way
as the CI checks them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mypy</span>
<span class="n">mypy</span> <span class="o">--</span><span class="n">config</span><span class="o">=</span><span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">error</span><span class="o">-</span><span class="n">codes</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Alternatively, you can use the <a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to run this
on all staged files in your git repository, automatically using the same mypy version as
in the GitHub CI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">mypy</span>
</pre></div>
</div>
</section>
<section id="linting">
<h2>Linting<a class="headerlink" href="#linting" title="Link to this heading">#</a></h2>
<p>JAX uses the <a class="reference external" href="https://docs.astral.sh/ruff/">ruff</a> linter to ensure code
quality. You can check your local changes by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ruff</span>
<span class="n">ruff</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Alternatively, you can use the <a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to run this
on all staged files in your git repository, automatically using the same ruff version as
the GitHub tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">ruff</span>
</pre></div>
</div>
</section>
<section id="update-documentation">
<h2>Update documentation<a class="headerlink" href="#update-documentation" title="Link to this heading">#</a></h2>
<p>To rebuild the documentation, install several packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">docs</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>And then run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">html</span> <span class="n">docs</span> <span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">html</span> <span class="o">-</span><span class="n">j</span> <span class="n">auto</span>
</pre></div>
</div>
<p>This can take a long time because it executes many of the notebooks in the documentation source;
if youâ€™d prefer to build the docs without executing the notebooks, you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">html</span> <span class="o">-</span><span class="n">D</span> <span class="n">nb_execution_mode</span><span class="o">=</span><span class="n">off</span> <span class="n">docs</span> <span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">html</span> <span class="o">-</span><span class="n">j</span> <span class="n">auto</span>
</pre></div>
</div>
<p>You can then see the generated documentation in <code class="docutils literal notranslate"><span class="pre">docs/build/html/index.html</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-j</span> <span class="pre">auto</span></code> option controls the parallelism of the build. You can use a number
in place of <code class="docutils literal notranslate"><span class="pre">auto</span></code> to control how many CPU cores to use.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Update notebooks"></a><section id="update-notebooks">
<span id="id2"></span><h3>Update notebooks<a class="headerlink" href="#update-notebooks" title="Link to this heading">#</a></h3>
<p>We use <a class="reference external" href="https://jupytext.readthedocs.io/">jupytext</a> to maintain two synced copies of the notebooks
in <code class="docutils literal notranslate"><span class="pre">docs/notebooks</span></code>: one in <code class="docutils literal notranslate"><span class="pre">ipynb</span></code> format, and one in <code class="docutils literal notranslate"><span class="pre">md</span></code> format. The advantage of the former
is that it can be opened and executed directly in Colab; the advantage of the latter is that
it makes it much easier to track diffs within version control.</p>
<section id="editing-ipynb">
<h4>Editing <code class="docutils literal notranslate"><span class="pre">ipynb</span></code><a class="headerlink" href="#editing-ipynb" title="Link to this heading">#</a></h4>
<p>For making large changes that substantially modify code and outputs, it is easiest to
edit the notebooks in Jupyter or in Colab. To edit notebooks in the Colab interface,
open <a class="reference external" href="http://colab.research.google.com">http://colab.research.google.com</a> and <code class="docutils literal notranslate"><span class="pre">Upload</span></code> from your local repo.
Update it as needed, <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">all</span> <span class="pre">cells</span></code> then <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">ipynb</span></code>.
You may want to test that it executes properly, using <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> as explained above.</p>
</section>
<section id="editing-md">
<h4>Editing <code class="docutils literal notranslate"><span class="pre">md</span></code><a class="headerlink" href="#editing-md" title="Link to this heading">#</a></h4>
<p>For making smaller changes to the text content of the notebooks, it is easiest to edit the
<code class="docutils literal notranslate"><span class="pre">.md</span></code> versions using a text editor.</p>
</section>
<section id="syncing-notebooks">
<h4>Syncing notebooks<a class="headerlink" href="#syncing-notebooks" title="Link to this heading">#</a></h4>
<p>After editing either the ipynb or md versions of the notebooks, you can sync the two versions
using <a class="reference external" href="https://jupytext.readthedocs.io/">jupytext</a> by running <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code> on the updated
notebooks; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jupytext</span><span class="o">==</span><span class="mf">1.16.0</span>
<span class="n">jupytext</span> <span class="o">--</span><span class="n">sync</span> <span class="n">docs</span><span class="o">/</span><span class="n">notebooks</span><span class="o">/</span><span class="n">quickstart</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>The jupytext version should match that specified in
<a class="reference external" href="https://github.com/google/jax/blob/main/.pre-commit-config.yaml">.pre-commit-config.yaml</a>.</p>
<p>To check that the markdown and ipynb files are properly synced, you may use the
<a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to perform the same check used
by the github CI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">add</span> <span class="n">docs</span> <span class="o">-</span><span class="n">u</span>  <span class="c1"># pre-commit runs on files in git staging.</span>
<span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">jupytext</span>
</pre></div>
</div>
</section>
<section id="creating-new-notebooks">
<h4>Creating new notebooks<a class="headerlink" href="#creating-new-notebooks" title="Link to this heading">#</a></h4>
<p>If you are adding a new notebook to the documentation and would like to use the <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code>
command discussed here, you can set up your notebook for jupytext by using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupytext</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">formats</span> <span class="n">ipynb</span><span class="p">,</span><span class="n">md</span><span class="p">:</span><span class="n">myst</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">notebook</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>This works by adding a <code class="docutils literal notranslate"><span class="pre">"jupytext"</span></code> metadata field to the notebook file which specifies the
desired formats, and which the <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code> command recognizes when invoked.</p>
</section>
<section id="notebooks-within-the-sphinx-build">
<h4>Notebooks within the Sphinx build<a class="headerlink" href="#notebooks-within-the-sphinx-build" title="Link to this heading">#</a></h4>
<p>Some of the notebooks are built automatically as part of the pre-submit checks and
as part of the <a class="reference external" href="https://jax.readthedocs.io/en/latest">Read the docs</a> build.
The build will fail if cells raise errors. If the errors are intentional, you can either catch them,
or tag the cell with <code class="docutils literal notranslate"><span class="pre">raises-exceptions</span></code> metadata (<a class="reference external" href="https://github.com/google/jax/pull/2402/files">example PR</a>).
You have to add this metadata by hand in the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file. It will be preserved when somebody else
re-saves the notebook.</p>
<p>We exclude some notebooks from the build, e.g., because they contain long computations.
See <code class="docutils literal notranslate"><span class="pre">exclude_patterns</span></code> in <a class="reference external" href="https://github.com/google/jax/blob/main/docs/conf.py">conf.py</a>.</p>
</section>
</section>
<section id="documentation-building-on-readthedocs-io">
<h3>Documentation building on <code class="docutils literal notranslate"><span class="pre">readthedocs.io</span></code><a class="headerlink" href="#documentation-building-on-readthedocs-io" title="Link to this heading">#</a></h3>
<p>JAXâ€™s auto-generated documentation is at <a class="reference external" href="https://jax.readthedocs.io/">https://jax.readthedocs.io/</a>.</p>
<p>The documentation building is controlled for the entire project by the
<a class="reference external" href="https://readthedocs.org/dashboard/jax">readthedocs JAX settings</a>. The current settings
trigger a documentation build as soon as code is pushed to the GitHub <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.
For each code version, the building process is driven by the
<code class="docutils literal notranslate"><span class="pre">.readthedocs.yml</span></code> and the <code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code> configuration files.</p>
<p>For each automated documentation build you can see the
<a class="reference external" href="https://readthedocs.org/projects/jax/builds/">documentation build logs</a>.</p>
<p>If you want to test the documentation generation on Readthedocs, you can push code to the <code class="docutils literal notranslate"><span class="pre">test-docs</span></code>
branch. That branch is also built automatically, and you can
see the generated documentation <a class="reference external" href="https://jax.readthedocs.io/en/test-docs/">here</a>. If the documentation build
fails you may want to <a class="reference external" href="https://docs.readthedocs.io/en/stable/guides/wipe-environment.html">wipe the build environment for test-docs</a>.</p>
<p>For a local test, I was able to do it in a fresh directory by replaying the commands
I saw in the Readthedocs logs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkvirtualenv jax-docs  # A new virtualenv
mkdir jax-docs  # A new directory
cd jax-docs
git clone --no-single-branch --depth 50 https://github.com/google/jax
cd jax
git checkout --force origin/test-docs
git clean -d -f -f
workon jax-docs

python -m pip install --upgrade --no-cache-dir pip
python -m pip install --upgrade --no-cache-dir -I Pygments==2.3.1 setuptools==41.0.1 docutils==0.14 mock==1.0.1 pillow==5.4.1 alabaster&gt;=0.7,&lt;0.8,!=0.7.5 commonmark==0.8.1 recommonmark==0.5.0 'sphinx&lt;2' 'sphinx-rtd-theme&lt;0.5' 'readthedocs-sphinx-ext&lt;1.1'
python -m pip install --exists-action=w --no-cache-dir -r docs/requirements.txt
cd docs
python `which sphinx-build` -T -E -b html -d _build/doctrees-readthedocs -D language=en . _build/html
</pre></div>
</div>
</section>
</section>
</section>
</article>
<footer class="prev-next-footer">
<div class="prev-next-area">
<a class="left-prev" href="contributing.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Contributing to JAX</p>
</div>
</a>
<a class="right-next" href="jax_internal_api.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Internal APIs</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage" id="pst-page-navigation-heading-2">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav aria-labelledby="pst-page-navigation-heading-2" class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-or-installing-jaxlib">Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-jaxlib-with-pip">Installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with pip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-jaxlib-from-source">Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-jaxlib-from-source-with-a-modified-xla-repository">Building jaxlib from source with a modified XLA repository.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-notes-for-building-jaxlib-from-source-on-windows">Additional Notes for Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source on Windows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-notes-for-building-a-rocm-jaxlib-for-amd-gpus">Additional notes for building a ROCM <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> for AMD GPUs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-jax">Installing <code class="docutils literal notranslate"><span class="pre">jax</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-tests">Running the tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bazel">Using Bazel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pytest">Using <code class="docutils literal notranslate"><span class="pre">pytest</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-test-behavior">Controlling test behavior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#doctests">Doctests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#type-checking">Type checking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linting">Linting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-documentation">Update documentation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-notebooks">Update notebooks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#editing-ipynb">Editing <code class="docutils literal notranslate"><span class="pre">ipynb</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#editing-md">Editing <code class="docutils literal notranslate"><span class="pre">md</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#syncing-notebooks">Syncing notebooks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-new-notebooks">Creating new notebooks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notebooks-within-the-sphinx-build">Notebooks within the Sphinx build</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-building-on-readthedocs-io">Documentation building on <code class="docutils literal notranslate"><span class="pre">readthedocs.io</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By The JAX authors
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      Â© Copyright 2024, The JAX Authors. NumPy and SciPy documentation are copyright the respective authors..
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>
<footer class="bd-footer">
</footer>
</body>
</html>